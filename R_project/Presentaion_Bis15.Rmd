---
title: "Presentaion_Bis15"
author: "JKAbrams, ASrivatsa"
date: "2023-03-15"
output: powerpoint_presentation

---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
```

```{r,echo=FALSE,include=FALSE}
library(here)
library(tidyverse)
library(naniar)
library(janitor)
library(skimr)
library(ggplot2)
library(ggthemes)
library(RColorBrewer)
library(paletteer)
library(tidyr)
```

## Does culture moderate relationships between rumination and symptoms of depression and PTSD? 

-Based on 2022 paper, "https://journals.plos.org/plosone/article?id=10.1371/journal.pone.0278328" 
-Akshanth:      religion, gender, education(1-5; change to factors) 
-JKA:           depression, anxiety, age, trauma type for PTSD
-For Cultures Studied: First 109 participant ids are Euro-Australian, next 144 are Malaysian

## More Information About the Data

::::::{.columns}

:::{.column}
2 Cultures:  0,1 = Euro-Australian, Malaysian (convert to factors)
-Culture = Groups 1,2  = Euro-Australian, Malaysian (change to factors)
-Gender (convert to factors):              
 M = 1
 F = 2
Declined to state = 5  

-Education (Highest level achieved):
Secondary = 1
Post-secondary = 2
Undergrad degree = 3
Graduate degree = 4
Other = 5

-Religion codes:
None = 1
Christian = 2
Muslim = 3
Buddhist/Taoist = 4
Hindu = 5
Other (incl Sikh, Agnostic) = 6

:::
:::{.column}

PTSD dataset:


-Index trauma type (what the PTSD is thought to be in response to):

Accident/serious injury/illness = 1
Non-sexual assault/abuse = 2
Sexual assault/abuse = 3
Witnessing death = 4
War/natural disaster = 5
Other = 6       

-HADS = Hospital Anxiety and Depression Scale: 

had_sdep = depression subscale total
had_sanx = anxiety subscale total
had_stotal = overall HADS total

-pts_dtotal = overall score on PTSD assessment scale

-RRS-B = Brooding scale - want sum of all RRS scores
:::
::::::

## How Does Gender Affect Brooding Scores?
```{r, include=FALSE}
depress<-read_csv(here("R_project", "Rumination Depression.csv")) %>% clean_names
```

```{r,include=FALSE}
post_disorder<-read_csv(here("R_project","Rumination PTSD.csv")) %>% clean_names
```

```{r}

#write.csv( d, "Depression_data", row.names=FALSE)

d<-depress %>% 
  select(-age,-brooding_total,-anxiety_total,-depression_total) %>% 
  mutate_if(is.numeric,as.character )
d<-d %>% mutate(age=depress$age)
d<-d %>% mutate(brooding_total=depress$brooding_total)
d<-d %>% mutate(anxiety_total=depress$anxiety_total)
d<-d %>% mutate(depression_total=depress$depression_total)
new_education<-d %>% select(education) %>% 
mutate_if( is.character, as.factor)

```

```{r}

  
d["culture"][d["culture"]==0]<-"Australian"
d["culture"][d["culture"]==1]<-"Malaysian"  
d["gender"][d["gender"]==1]<-"M"
d["gender"][d["gender"]==2]<-"F"
d["gender"][d["gender"]==5]<-"Declined to State"
d["education"][d["education"]==1]<-"Secondary"
d["education"][d["education"]==2]<-"Post-secondary"
d["education"][d["education"]==3]<-"Undergrad degree"
d["education"][d["education"]==4]<-"Graduate degree"
d["education"][d["education"]==5]<-"Other"
d["religion_coded"][d["religion_coded"]==1]<-"None"
d["religion_coded"][d["religion_coded"]==2]<-"Christian"
d["religion_coded"][d["religion_coded"]==3]<-"Muslim"
d["religion_coded"][d["religion_coded"]==4]<-"Buddhist/Taoist"
d["religion_coded"][d["religion_coded"]==5]<-"Hindu"
d["religion_coded"][d["religion_coded"]==6]<-"Other (incl Sikh, Agnostic)"
# d<-d %>% 
#   select(-education) %>% mutate(education=new_education$education)

d <- d %>% 
  mutate(age_cat = case_when(age < 21 ~ "teens",
                             age >= 21 & age < 25 ~ "earlytwens",
                             age >= 25 & age < 30 ~ "latetwens",
                             age >= 30 & age < 35 ~ "earlythirs",
                             age >= 35 & age < 40 ~ "latethirs",
                             age >= 40 & age < 45 ~ "earlyfors",
                             age >= 45 & age < 50 ~ "latefors",
                             age >= 50 & age < 55 ~ "earlyfifs",
                             age >= 55 & age < 60 ~ "latefifs",
                             age >= 60 ~ "sixties"))

```

```{r d}
d %>% 
  filter(!is.na(age)) %>% 
  ggplot(aes(x=gender, y= brooding_total, fill=culture))+geom_col(na.rm=T)+facet_wrap(culture~.)+labs(title="Gender versus Brooding Total")
```
## How does Religion and Education level affect Brooding Scores?

```{r}
d %>% 
  filter(!is.na(religion_coded)) %>% 
  ggplot(aes(x=religion_coded, y= brooding_total, fill=education))+geom_col(na.rm=T, position = "dodge")+facet_wrap(culture~.)+coord_flip()+labs(title="Brooding Scores for Each of the religions")
```

-Too complicated. Is there a better way to graph this?

## How does each religion affect Brooding scores?


-Only graphed Religions with differences of brooding scores*

```{r}
d %>% 
  filter(!is.na(religion_coded)&religion_coded=="None") %>% 
    ggplot(aes(x=religion_coded, y= brooding_total, fill=education)) +geom_col(na.rm=T, position = "dodge") +facet_wrap(culture~.)+coord_flip()+labs(title="Brooding Score versus Religion: None")
```


## 1st Religous Brooding Score

```{r}
d %>% 
  filter(!is.na(religion_coded)&religion_coded=="Muslim") %>% 
    ggplot(aes(x=religion_coded, y= brooding_total, fill=education)) +geom_col(na.rm=T, position = "dodge") +facet_wrap(culture~.)+coord_flip()+labs(title="Brooding Score versus Religion: Muslim")
```


## 2nd Religous Brooding Score

```{r}
d %>% 
  filter(!is.na(religion_coded)&religion_coded=="Hindu") %>% 
    ggplot(aes(x=religion_coded, y= brooding_total, fill=education)) +geom_col(na.rm=T, position = "dodge") +facet_wrap(culture~.)+coord_flip()+labs(title="Brooding Score versus Religion: Hindu")
```
## How does Depression Scores affect Brooding scores?


```{r}
d %>% 
  filter(!is.na(culture)) %>% 
  ggplot(aes(x=depression_total, y=brooding_total, fill=culture))+geom_smooth(method="loess", na.rm = T, )+facet_wrap(culture~.)+labs(title="Curve of Sum of Depression Scores versus their Brooding Scores")
      
```





